import{aV as m}from"./index-BSnuJ0tf.js";import{w as E,u as x,S as k}from"./xlsx-PuJ-vIrN.js";var y={exports:{}},F=y.exports,A;function U(){return A||(A=1,function(v,p){(function(c,o){o()})(F,function(){function c(e,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function o(e,t,i){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,t,i)},n.onerror=function(){console.error("could not download file")},n.send()}function s(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof m=="object"&&m.global===m?m:void 0,h=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=r.saveAs||(typeof window!="object"||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!h?function(e,t,i){var n=r.URL||r.webkitURL,f=document.createElement("a");t=t||e.name||"download",f.download=t,f.rel="noopener",typeof e=="string"?(f.href=e,f.origin===location.origin?a(f):s(f.href)?o(e,t,i):a(f,f.target="_blank")):(f.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(f.href)},4e4),setTimeout(function(){a(f)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,i){if(t=t||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(c(e,i),t);else if(s(e))o(e,t,i);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){a(n)})}}:function(e,t,i,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return o(e,t,i);var f=e.type==="application/octet-stream",u=/constructor/i.test(r.HTMLElement)||r.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||f&&u||h)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var w=S.result;w=d?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=w:location=w,n=null},S.readAsDataURL(e)}else{var _=r.URL||r.webkitURL,g=_.createObjectURL(e);n?n.location=g:location.href=g,n=null,setTimeout(function(){_.revokeObjectURL(g)},4e4)}});r.saveAs=l.saveAs=l,v.exports=l})}(y)),y.exports}var j=U();function B(v){for(var p=[],c=v.querySelectorAll("tr"),o=[],s=0;s<c.length;++s){for(var a=[],r=c[s],h=r.querySelectorAll("td"),l=0;l<h.length;++l){var e=h[l],t=e.getAttribute("colspan"),i=e.getAttribute("rowspan"),n=e.innerText;if(n!==""&&n==+n&&(n=+n),o.forEach(function(u){if(s>=u.s.r&&s<=u.e.r&&a.length>=u.s.c&&a.length<=u.e.c)for(var d=0;d<=u.e.c-u.s.c;++d)a.push(null)}),(i||t)&&(i=i||1,t=t||1,o.push({s:{r:s,c:a.length},e:{r:s+i-1,c:a.length+t-1}})),a.push(n!==""?n:null),t)for(var f=0;f<t-1;++f)a.push(null)}p.push(a)}return[p,o]}function O(v,p){var c=Date.parse(v);return(c-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3)}function T(v,p){for(var c={},o={s:{c:1e7,r:1e7},e:{c:0,r:0}},s=0;s!=v.length;++s)for(var a=0;a!=v[s].length;++a){o.s.r>s&&(o.s.r=s),o.s.c>a&&(o.s.c=a),o.e.r<s&&(o.e.r=s),o.e.c<a&&(o.e.c=a);var r={v:v[s][a]};if(r.v!=null){var h=x.encode_cell({c:a,r:s});typeof r.v=="number"?r.t="n":typeof r.v=="boolean"?r.t="b":r.v instanceof Date?(r.t="n",r.z=k._table[14],r.v=O(r.v)):r.t="s",c[h]=r}}return o.s.c<1e7&&(c["!ref"]=x.encode_range(o)),c}function b(){if(!(this instanceof b))return new b;this.SheetNames=[],this.Sheets={}}function L(v){for(var p=new ArrayBuffer(v.length),c=new Uint8Array(p),o=0;o!=v.length;++o)c[o]=v.charCodeAt(o)&255;return p}function q(v){var p=document.getElementById(v),c=B(p),o=c[1],s=c[0],a="SheetJS",r=new b,h=T(s);h["!merges"]=o,r.SheetNames.push(a),r.Sheets[a]=h;var l=E(r,{bookType:"xlsx",bookSST:!1,type:"binary"});j.saveAs(new Blob([L(l)],{type:"application/octet-stream"}),"test.xlsx")}function H({multiHeader:v=[],header:p,data:c,filename:o,merges:s=[],autoWidth:a=!0,bookType:r="xlsx"}={}){o=o||"excel-list",c=[...c],c.unshift(p);for(let i=v.length-1;i>-1;i--)c.unshift(v[i]);var h="SheetJS",l=new b,e=T(c);if(s.length>0&&(e["!merges"]||(e["!merges"]=[]),s.forEach(i=>{e["!merges"].push(x.decode_range(i))})),a){const i=c.map(f=>f.map(u=>u==null?{wch:10}:u.toString().charCodeAt(0)>255?{wch:u.toString().length*2}:{wch:u.toString().length}));let n=i[0];for(let f=1;f<i.length;f++)for(let u=0;u<i[f].length;u++)n[u].wch<i[f][u].wch&&(n[u].wch=i[f][u].wch);e["!cols"]=n}l.SheetNames.push(h),l.Sheets[h]=e;var t=E(l,{bookType:r,bookSST:!1,type:"binary"});j.saveAs(new Blob([L(t)],{type:"application/octet-stream"}),`${o}.${r}`)}export{H as export_json_to_excel,q as export_table_to_excel};
