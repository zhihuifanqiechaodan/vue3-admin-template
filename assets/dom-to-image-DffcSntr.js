import{ay as ae,P as ie,Q as ue,c as ce,o as se,ab as H,a2 as J,ah as F,ac as G,aq as le}from"./index-BSnuJ0tf.js";var M={exports:{}},$;function fe(){return $||($=1,function(V){(function(L){var i=te(),y=ne(),S=re(),k=oe(),P={imagePlaceholder:void 0,cacheBust:!1},d={toSvg:U,toPng:W,toJpeg:z,toBlob:Q,toPixelData:X,impl:{fontFaces:S,images:k,util:i,inliner:y,options:{}}};V.exports=d;function U(n,t){return t=t||{},K(t),Promise.resolve(n).then(function(a){return O(a,t.filter,!0)}).then(Y).then(Z).then(r).then(function(a){return ee(a,t.width||i.width(n),t.height||i.height(n))});function r(a){return t.bgcolor&&(a.style.backgroundColor=t.bgcolor),t.width&&(a.style.width=t.width+"px"),t.height&&(a.style.height=t.height+"px"),t.style&&Object.keys(t.style).forEach(function(l){a.style[l]=t.style[l]}),a}}function X(n,t){return N(n,t||{}).then(function(r){return r.getContext("2d").getImageData(0,0,i.width(n),i.height(n)).data})}function W(n,t){return N(n,t||{}).then(function(r){return r.toDataURL()})}function z(n,t){return t=t||{},N(n,t).then(function(r){return r.toDataURL("image/jpeg",t.quality||1)})}function Q(n,t){return N(n,t||{}).then(i.canvasToBlob)}function K(n){typeof n.imagePlaceholder>"u"?d.impl.options.imagePlaceholder=P.imagePlaceholder:d.impl.options.imagePlaceholder=n.imagePlaceholder,typeof n.cacheBust>"u"?d.impl.options.cacheBust=P.cacheBust:d.impl.options.cacheBust=n.cacheBust}function N(n,t){return U(n,t).then(i.makeImage).then(i.delay(100)).then(function(a){var l=r(n);return l.getContext("2d").drawImage(a,0,0),l});function r(a){var l=document.createElement("canvas");if(l.width=t.width||i.width(a),l.height=t.height||i.height(a),t.bgcolor){var s=l.getContext("2d");s.fillStyle=t.bgcolor,s.fillRect(0,0,l.width,l.height)}return l}}function O(n,t,r){if(!r&&t&&!t(n))return Promise.resolve();return Promise.resolve(n).then(a).then(function(o){return l(n,o,t)}).then(function(o){return s(n,o)});function a(o){return o instanceof HTMLCanvasElement?i.makeImage(o.toDataURL()):o.cloneNode(!1)}function l(o,u,v){var x=o.childNodes;if(x.length===0)return Promise.resolve(u);return m(u,i.asArray(x),v).then(function(){return u});function m(D,w,g){var b=Promise.resolve();return w.forEach(function(B){b=b.then(function(){return O(B,g)}).then(function(E){E&&D.appendChild(E)})}),b}}function s(o,u){if(!(u instanceof Element))return u;return Promise.resolve().then(v).then(x).then(m).then(D).then(function(){return u});function v(){w(window.getComputedStyle(o),u.style);function w(g,b){g.cssText?b.cssText=g.cssText:B(g,b);function B(E,A){i.asArray(E).forEach(function(e){A.setProperty(e,E.getPropertyValue(e),E.getPropertyPriority(e))})}}}function x(){[":before",":after"].forEach(function(g){w(g)});function w(g){var b=window.getComputedStyle(o,g),B=b.getPropertyValue("content");if(B===""||B==="none")return;var E=i.uid();u.className=u.className+" "+E;var A=document.createElement("style");A.appendChild(e(E,g,b)),u.appendChild(A);function e(c,h,f){var p="."+c+":"+h,T=f.cssText?_(f):j(f);return document.createTextNode(p+"{"+T+"}");function _(C){var I=C.getPropertyValue("content");return C.cssText+" content: "+I+";"}function j(C){return i.asArray(C).map(I).join("; ")+";";function I(R){return R+": "+C.getPropertyValue(R)+(C.getPropertyPriority(R)?" !important":"")}}}}}function m(){o instanceof HTMLTextAreaElement&&(u.innerHTML=o.value),o instanceof HTMLInputElement&&u.setAttribute("value",o.value)}function D(){u instanceof SVGElement&&(u.setAttribute("xmlns","http://www.w3.org/2000/svg"),u instanceof SVGRectElement&&["width","height"].forEach(function(w){var g=u.getAttribute(w);g&&u.style.setProperty(w,g)}))}}}function Y(n){return S.resolveAll().then(function(t){var r=document.createElement("style");return n.appendChild(r),r.appendChild(document.createTextNode(t)),n})}function Z(n){return k.inlineAll(n).then(function(){return n})}function ee(n,t,r){return Promise.resolve(n).then(function(a){return a.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(a)}).then(i.escapeXhtml).then(function(a){return'<foreignObject x="0" y="0" width="100%" height="100%">'+a+"</foreignObject>"}).then(function(a){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+a+"</svg>"}).then(function(a){return"data:image/svg+xml;charset=utf-8,"+a})}function te(){return{escape:D,parseExtension:t,mimeType:r,dataAsUrl:m,isDataUrl:a,canvasToBlob:s,resolveUrl:o,getAndEncode:x,uid:u(),delay:w,asArray:g,escapeXhtml:b,makeImage:v,width:B,height:E};function n(){var e="application/font-woff",c="image/jpeg";return{woff:e,woff2:e,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:c,jpeg:c,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"}}function t(e){var c=/\.([^\.\/]*?)$/g.exec(e);return c?c[1]:""}function r(e){var c=t(e).toLowerCase();return n()[c]||""}function a(e){return e.search(/^(data:)/)!==-1}function l(e){return new Promise(function(c){for(var h=window.atob(e.toDataURL().split(",")[1]),f=h.length,p=new Uint8Array(f),T=0;T<f;T++)p[T]=h.charCodeAt(T);c(new Blob([p],{type:"image/png"}))})}function s(e){return e.toBlob?new Promise(function(c){e.toBlob(c)}):l(e)}function o(e,c){var h=document.implementation.createHTMLDocument(),f=h.createElement("base");h.head.appendChild(f);var p=h.createElement("a");return h.body.appendChild(p),f.href=c,p.href=e,p.href}function u(){var e=0;return function(){return"u"+c()+e++;function c(){return("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)}}}function v(e){return new Promise(function(c,h){var f=new Image;f.onload=function(){c(f)},f.onerror=h,f.src=e})}function x(e){var c=3e4;return d.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime()),new Promise(function(h){var f=new XMLHttpRequest;f.onreadystatechange=_,f.ontimeout=j,f.responseType="blob",f.timeout=c,f.open("GET",e,!0),f.send();var p;if(d.impl.options.imagePlaceholder){var T=d.impl.options.imagePlaceholder.split(/,/);T&&T[1]&&(p=T[1])}function _(){if(f.readyState===4){if(f.status!==200){p?h(p):C("cannot fetch resource: "+e+", status: "+f.status);return}var I=new FileReader;I.onloadend=function(){var R=I.result.split(/,/)[1];h(R)},I.readAsDataURL(f.response)}}function j(){p?h(p):C("timeout of "+c+"ms occured while fetching resource: "+e)}function C(I){console.error(I),h("")}})}function m(e,c){return"data:"+c+";base64,"+e}function D(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")}function w(e){return function(c){return new Promise(function(h){setTimeout(function(){h(c)},e)})}}function g(e){for(var c=[],h=e.length,f=0;f<h;f++)c.push(e[f]);return c}function b(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")}function B(e){var c=A(e,"border-left-width"),h=A(e,"border-right-width");return e.scrollWidth+c+h}function E(e){var c=A(e,"border-top-width"),h=A(e,"border-bottom-width");return e.scrollHeight+c+h}function A(e,c){var h=window.getComputedStyle(e).getPropertyValue(c);return parseFloat(h.replace("px",""))}}function ne(){var n=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:l,shouldProcess:t,impl:{readUrls:r,inline:a}};function t(s){return s.search(n)!==-1}function r(s){for(var o=[],u;(u=n.exec(s))!==null;)o.push(u[1]);return o.filter(function(v){return!i.isDataUrl(v)})}function a(s,o,u,v){return Promise.resolve(o).then(function(m){return u?i.resolveUrl(m,u):m}).then(v||i.getAndEncode).then(function(m){return i.dataAsUrl(m,i.mimeType(o))}).then(function(m){return s.replace(x(o),"$1"+m+"$3")});function x(m){return new RegExp(`(url\\(['"]?)(`+i.escape(m)+`)(['"]?\\))`,"g")}}function l(s,o,u){if(v())return Promise.resolve(s);return Promise.resolve(s).then(r).then(function(x){var m=Promise.resolve(s);return x.forEach(function(D){m=m.then(function(w){return a(w,D,o,u)})}),m});function v(){return!t(s)}}}function re(){return{resolveAll:n,impl:{readAll:t}};function n(){return t().then(function(r){return Promise.all(r.map(function(a){return a.resolve()}))}).then(function(r){return r.join(`
`)})}function t(){return Promise.resolve(i.asArray(document.styleSheets)).then(a).then(r).then(function(s){return s.map(l)});function r(s){return s.filter(function(o){return o.type===CSSRule.FONT_FACE_RULE}).filter(function(o){return y.shouldProcess(o.style.getPropertyValue("src"))})}function a(s){var o=[];return s.forEach(function(u){try{i.asArray(u.cssRules||[]).forEach(o.push.bind(o))}catch(v){console.log("Error while reading CSS rules from "+u.href,v.toString())}}),o}function l(s){return{resolve:function(){var u=(s.parentStyleSheet||{}).href;return y.inlineAll(s.cssText,u)},src:function(){return s.style.getPropertyValue("src")}}}}}function oe(){return{inlineAll:t,impl:{newImage:n}};function n(r){return{inline:a};function a(l){return i.isDataUrl(r.src)?Promise.resolve():Promise.resolve(r.src).then(l||i.getAndEncode).then(function(s){return i.dataAsUrl(s,i.mimeType(r.src))}).then(function(s){return new Promise(function(o,u){r.onload=o,r.onerror=u,r.src=s})})}}function t(r){if(!(r instanceof Element))return Promise.resolve(r);return a(r).then(function(){return r instanceof HTMLImageElement?n(r).inline():Promise.all(i.asArray(r.childNodes).map(function(l){return t(l)}))});function a(l){var s=l.style.getPropertyValue("background");return s?y.inlineAll(s).then(function(o){l.style.setProperty("background",o,l.style.getPropertyPriority("background"))}).then(function(){return l}):Promise.resolve(l)}}}})()}(M)),M.exports}var he=fe();const q=ae(he),me=()=>({toJpeg:async(i,y={},S="domToImage")=>{q.toJpeg(i,y).then(function(k){const P=document.createElement("a");P.download=`${S}.jpeg`,P.href=k,P.click()})},toPng:async(i,y={},S="domToImage")=>{q.toPng(i,y).then(function(k){const P=document.createElement("a");P.download=`${S}.png`,P.href=k,P.click()})}}),de={class:"dom-to-image-container"},pe={__name:"dom-to-image",setup(V){const L=me(),i=ie({refDom:null}),{refDom:y}=ue(i),S=()=>{L.toJpeg(y.value)},k=()=>{L.toPng(y.value)};return(P,d)=>{const U=le;return se(),ce("div",de,[H("aside",{ref_key:"refDom",ref:y},d[0]||(d[0]=[H("a",{href:"https://github.com/tsayen/dom-to-image",target:"_blank"},"dom-to-image",-1),F(" is a library which can turn arbitrary DOM node into a vector (SVG) or raster (PNG or JPEG) image, written in JavaScript. It's based on domvas by Paul Bakaus and has been completely rewritten, with some bugs fixed and some new features (like web font and image support) added. ")]),512),J(U,{onClick:S,type:"primary"},{default:G(()=>d[1]||(d[1]=[F("下载 jpeg")])),_:1}),J(U,{onClick:k,type:"primary"},{default:G(()=>d[2]||(d[2]=[F("下载 Png")])),_:1})])}}};export{pe as default};
