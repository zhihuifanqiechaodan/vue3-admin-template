import{P as B,Q as E,c as b,o as f,ab as N,ah as S,a2 as y,ac as C,V as _,aq as V,a3 as z,av as h,aD as F,ad as O,aG as $,aH as A}from"./index-BSnuJ0tf.js";import{r as j,u as d}from"./xlsx-PuJ-vIrN.js";const q={__name:"index",props:{size:{type:Number,default:5}},emits:["uploadSuccess"],setup(D,{emit:o}){const g=o,p=D,s=B({loading:!1,refInput:null}),{loading:n,refInput:k}=E(s),m=e=>{const t=[],a=d.decode_range(e["!ref"]);let r;const i=a.s.r;for(r=a.s.c;r<=a.e.c;++r){const c=e[d.encode_cell({c:r,r:i})];let u="UNKNOWN "+r;c&&c.t&&(u=d.format_cell(c)),t.push(u)}return t},x=e=>{s.loading=!0;const t=new FileReader;t.onload=a=>{const r=a.target.result,i=j(r,{type:"array"}),c=i.SheetNames[0],u=i.Sheets[c],R=m(u),U=d.sheet_to_json(u);g("uploadSuccess",{header:R,results:U}),s.loading=!1},t.readAsArrayBuffer(e)},l=e=>e.size/1024/1024<p.size?!0:(h.warning(`Please do not upload files larger than ${p.size}m in size.`),!1),v=e=>{s.refInput.value=null,l(e)&&x(e)},H=e=>{const a=e.target.files[0];a&&v(a)},I=e=>/\.(xlsx|xls|csv)$/.test(e.name),T=e=>{if(e.stopPropagation(),e.preventDefault(),s.loading)return;const t=e.dataTransfer.files;if(t.length!==1)return h.error("Only support uploading one file!");const a=t[0];if(!I(a))return h.error("Only supports upload .xlsx, .xls, .csv suffix files");v(a)},w=e=>{e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},P=()=>{s.refInput.click()};return(e,t)=>{const a=V;return f(),b(z,null,[N("input",{ref_key:"refInput",ref:k,class:"excel-upload-input",type:"file",accept:".xlsx, .xls",onChange:H},null,544),N("div",{class:"drop",onDrop:T,onDragover:w,onDragenter:w},[t[1]||(t[1]=S(" Drop excel file here or ")),y(a,{loading:_(n),style:{"margin-left":"16px"},type:"primary",onClick:P},{default:C(()=>t[0]||(t[0]=[S(" Browse ")])),_:1},8,["loading"])],32)],64)}}},G={class:"upload-excel-container"},M={__name:"upload-excel",setup(D){const o=B({tableData:[],tableHeader:[]}),{tableData:g,tableHeader:p}=E(o),s=n=>{o.tableData=n.results,o.tableHeader=n.header};return(n,k)=>{const m=$,x=A;return f(),b("div",G,[y(_(q),{onUploadSuccess:s}),y(x,{data:_(g),border:"","highlight-current-row":"",style:{width:"100%","margin-top":"20px"}},{default:C(()=>[(f(!0),b(z,null,F(_(p),l=>(f(),O(m,{key:l,prop:l,label:l},null,8,["prop","label"]))),128))]),_:1},8,["data"])])}}};export{M as default};
